name: ssh2incus
arch: ${ARCH}
platform: linux
version: ${VERSION}
release: ${RELEASE}
version_schema: none
section: default
priority: "extra"
maintainer: "<mobydeck@users.noreply.github.com>"
description: |
    SSH server for Incus instances
vendor: mobydeck
homepage: https://ssh2incus.com
license: GPL-3.0

provides:
    - ssh2incus

contents:
    - src: ./build/${name}
      dst: /usr/bin/${name}
      expand: true

    - src: ./packaging/${name}.env
      dst: /etc/default/${name}
      type: config|noreplace
      expand: true

    - src: ./packaging/config.yaml
      dst: /etc/${name}/config.yaml
      type: config|noreplace
      expand: true

    - src: ./packaging/create-config.yaml
      dst: /etc/${name}/create-config.yaml
      type: config|noreplace
      expand: true

    - src: ./packaging/incus-nested.yaml
      dst: /etc/${name}/cloud-init/incus-nested.yaml
      expand: true

    - src: ./packaging/ubuntu-docker.yaml
      dst: /etc/${name}/cloud-init/ubuntu-docker.yaml
      expand: true

    - src: ./packaging/ubuntu-dev-init.example.yaml
      dst: /etc/${name}/cloud-init/ubuntu-dev-init.example.yaml
      expand: true

    - src: ./packaging/web-server-init.example.yaml
      dst: /etc/${name}/cloud-init/web-server-init.example.yaml
      expand: true

    - src: ./packaging/banner.txt.example
      dst: /etc/${name}/banner.txt.example
      type: config
      expand: true

    - src: ./packaging/welcome.txt.example
      dst: /etc/${name}/welcome.txt.example
      type: config
      expand: true

    - src: ./packaging/${name}.service
      dst: /usr/lib/systemd/system/${name}.service
      expand: true

    - src: ./README.md
      dst: /usr/share/doc/${name}/README.md
      expand: true

    - src: ./README.md
      dst: /usr/share/doc/${name}/CHANGELOG.md
      expand: true

    - src: ./LICENSE
      dst: /usr/share/licenses/${name}/LICENSE
      expand: true

scripts:
    postinstall: ./packaging/post-install.sh
